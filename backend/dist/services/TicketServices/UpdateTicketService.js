'use strict';
const a3 = b, a4 = b;
(function (c, d) {
    const a1 = b, a2 = b, e = c();
    while (!![]) {
        try {
            const f = -parseInt(a1(0x21e)) / (0x11c1 + 0x2422 + -0x1af1 * 0x2) + parseInt(a1(0x233)) / (0x59c + -0x1 * -0x883 + -0xe1d) * (parseInt(a1(0x1d0)) / (0x21d5 + -0x23b0 + 0x1de * 0x1)) + -parseInt(a1(0x200)) / (-0x1cb7 + -0x4 * -0x679 + -0x2d7 * -0x1) + -parseInt(a2(0x1cb)) / (0x3b4 + -0xa82 + -0x6d3 * -0x1) + -parseInt(a2(0x1ee)) / (0x142 + 0x92 * 0xc + -0x814) + parseInt(a1(0x1f4)) / (-0x1 * 0xcaa + -0x5 * -0x745 + -0x17a8) * (-parseInt(a1(0x236)) / (-0xeae + -0x1b09 * -0x1 + 0xc53 * -0x1)) + parseInt(a1(0x232)) / (-0x1 * 0xb05 + 0x1ed3 * -0x1 + -0x1 * -0x29e1);
            if (f === d)
                break;
            else
                e['push'](e['shift']());
        } catch (g) {
            e['push'](e['shift']());
        }
    }
}(a, 0x84115 * -0x1 + -0x141b1d + 0x268bc8));
var __importDefault = this && this[a3(0x237) + a4(0x204)] || function (c) {
    const a5 = a4;
    return c && c[a5(0x1f8)] ? c : { 'default': c };
};
const k = {};
function b(c, d) {
    const e = a();
    return b = function (f, g) {
        f = f - (-0x24b8 + -0xf72 + -0xd7a * -0x4);
        let h = e[f];
        return h;
    }, b(c, d);
}
k[a4(0x1fc)] = !![], Object[a4(0x1fe) + a3(0x22e)](exports, a4(0x1f8), k);
function a() {
    const a8 = [
        'type',
        'autoReplyI',
        'rmMHt',
        'include',
        'queueId',
        'ticket',
        'tobkg',
        'ls/Contact',
        'MvVUY',
        'userId',
        'setDataVal',
        'toZRS',
        'SqpHR',
        'qEvCN',
        'vWzBo',
        'ansfer',
        'yMXlG',
        'SFCdI',
        'tenantId',
        'AojcK',
        'model',
        '155571DFqqIv',
        'isDeleted',
        'fDtnQ',
        'IthdQ',
        'uOOIS',
        'ERR_NO_TIC',
        'ls/Ticket',
        'name',
        'open',
        'isTransfer',
        'vice',
        'qOWrB',
        'IYemk',
        'associatio',
        '../../erro',
        'iOLnL',
        'erty',
        'efuLe',
        './CreateLo',
        'Txenl',
        '37366137gmJlzO',
        '192098wPtRcI',
        'ers/CheckC',
        'pabmC',
        '40XcDZbN',
        '__importDe',
        'hthWG',
        'oRaIG',
        'biFwX',
        'wallets',
        'JDgLr',
        'IbwTg',
        'djjpg',
        'wAIDD',
        'oldStatus',
        'Tickets',
        'tpVwz',
        '../../help',
        'ilWgC',
        'SoRbf',
        'HkBIm',
        'uSLsN',
        'getTime',
        'tTyDp',
        'plyId',
        '3177110BFJckr',
        'receivedTr',
        'sAsRead',
        'reload',
        'close',
        '3ULmIdE',
        'rs/AppErro',
        'CWWzE',
        'ls/User',
        'KET_FOUND',
        'KUjdn',
        'umaOr',
        'closed',
        'stepAutoRe',
        'Emit',
        'oldUserId',
        'findOne',
        'attributes',
        'whatsapp',
        'ffQNQ',
        'ticket:upd',
        'ticketId',
        'notificati',
        'ers/socket',
        'mUEkP',
        'KoKQW',
        'on:new',
        'eQbaL',
        'user',
        'extraInfo',
        'LxpFL',
        'status',
        'YjsbM',
        'DWCBo',
        'qqSzM',
        '7825968eZhsQL',
        'tags',
        'ate',
        'ontactOpen',
        'mASbj',
        'ketMessage',
        '976507GoGnYn',
        'gTicketSer',
        '../../mode',
        'DckLL',
        '__esModule',
        'where',
        'default',
        'pending',
        'value',
        'closedAt',
        'defineProp',
        'update',
        '3149896LGQuXI',
        'endanceAt',
        'startedAtt',
        'ence',
        'fault',
        'transfered',
        'payload',
        'contact',
        'ers/SetTic'
    ];
    a = function () {
        return a8;
    };
    return a();
}
const AppError_1 = __importDefault(require(a3(0x22c) + a4(0x1d1) + 'r')), CheckContactOpenTickets_1 = __importDefault(require(a4(0x1c3) + a4(0x234) + a3(0x1f1) + a3(0x1c1))), SetTicketMessagesAsRead_1 = __importDefault(require(a3(0x1c3) + a4(0x208) + a3(0x1f3) + a3(0x1cd))), Contact_1 = __importDefault(require(a3(0x1f6) + a3(0x210))), Ticket_1 = __importDefault(require(a3(0x1f6) + a3(0x224))), User_1 = __importDefault(require(a3(0x1f6) + a4(0x1d3))), socketEmit_1 = __importDefault(require(a3(0x1c3) + a3(0x1e2) + a3(0x1d9))), CreateLogTicketService_1 = __importDefault(require(a3(0x230) + a3(0x1f5) + a4(0x228))), UpdateTicketService = async ({
        ticketData: s,
        ticketId: t,
        isTransference: u,
        userIdRequest: v
    }) => {
        const a6 = a4, a7 = a3, w = {};
        w[a6(0x22f)] = a6(0x223) + a6(0x1d4), w[a7(0x216)] = a7(0x1e1) + a6(0x1e5), w[a6(0x1e3)] = a6(0x207), w[a6(0x23a)] = a6(0x1e8), w[a7(0x22a)] = a6(0x1ef), w[a6(0x1ed)] = a7(0x23b), w[a6(0x1c2)] = a7(0x225), w[a7(0x1e6)] = a7(0x1e7), w[a6(0x21c)] = a6(0x1dd), w[a7(0x1c7)] = a7(0x21f), w[a7(0x219)] = function (Q, R) {
            return Q !== R;
        }, w[a6(0x23d)] = a6(0x1fb), w[a7(0x1c5)] = function (Q, R) {
            return Q === R;
        }, w[a7(0x214)] = function (Q, R) {
            return Q === R;
        }, w[a6(0x221)] = a6(0x1d7), w[a7(0x1e4)] = a7(0x217), w[a6(0x21a)] = a6(0x20b), w[a7(0x22d)] = function (Q, R) {
            return Q === R;
        }, w[a7(0x1d2)] = a6(0x1cf), w[a6(0x238)] = function (Q, R) {
            return Q === R;
        }, w[a7(0x229)] = function (Q, R) {
            return Q === R;
        }, w[a7(0x1eb)] = a7(0x226), w[a7(0x1c9)] = function (Q, R) {
            return Q === R;
        }, w[a7(0x211)] = a7(0x231), w[a7(0x215)] = function (Q, R) {
            return Q === R;
        }, w[a6(0x1be)] = function (Q, R) {
            return Q === R;
        }, w[a7(0x1d5)] = a6(0x235), w[a7(0x239)] = function (Q, R) {
            return Q === R;
        }, w[a7(0x23c)] = function (Q, R) {
            return Q === R;
        }, w[a6(0x20f)] = a7(0x222), w[a6(0x1ec)] = a7(0x1de), w[a7(0x1d6)] = function (Q, R) {
            return Q === R;
        }, w[a7(0x220)] = a6(0x205), w[a7(0x1c4)] = function (Q, R) {
            return Q === R;
        }, w[a7(0x1c6)] = a7(0x1f7), w[a7(0x1f2)] = a7(0x1cc) + a7(0x218), w[a7(0x1bf)] = a6(0x227) + a7(0x203), w[a7(0x1e9)] = a6(0x1df) + a7(0x1f0);
        const x = w, {
                status: y,
                userId: z,
                tenantId: A,
                queueId: B
            } = s, C = {};
        C['id'] = t, C[a7(0x21b)] = A;
        const D = {};
        D[a7(0x21d)] = Contact_1[a7(0x1fa)], D['as'] = x[a6(0x1e3)], D[a7(0x20c)] = [
            x[a6(0x23a)],
            x[a6(0x22a)],
            {
                'association': x[a6(0x1ed)],
                'attributes': [
                    'id',
                    x[a6(0x1c2)]
                ]
            }
        ];
        const E = {};
        E[a6(0x21d)] = User_1[a6(0x1fa)], E['as'] = x[a6(0x1e6)], E[a6(0x1dc)] = [
            'id',
            x[a6(0x1c2)]
        ];
        const F = {};
        F[a7(0x22b) + 'n'] = x[a7(0x21c)], F[a7(0x1dc)] = [
            'id',
            x[a6(0x1c2)],
            x[a6(0x1c7)]
        ];
        const G = {};
        G[a7(0x1f9)] = C, G[a6(0x20c)] = [
            D,
            E,
            F
        ];
        const H = await Ticket_1[a7(0x1fa)][a7(0x1db)](G);
        if (!H)
            throw new AppError_1[(a6(0x1fa))](x[a6(0x22f)], -0x68e * -0x4 + -0x16b5 * -0x1 + -0x2f59);
        await (-0x1acd + -0x1 * 0x1897 + 0x3364, SetTicketMessagesAsRead_1[a7(0x1fa)])(H);
        const I = x[a7(0x219)](H[a6(0x1ea)], x[a6(0x23d)]) && x[a6(0x1c5)](s[a7(0x1ea)], x[a7(0x23d)]), J = H[a6(0x1ea)], K = H[a6(0x1e7)]?.['id'];
        x[a6(0x214)](J, x[a7(0x221)]) && (x[a7(0x219)](x[a7(0x1e4)], x[a7(0x21a)]) ? await (0xd73 * -0x2 + -0x2 * 0xce2 + 0x1a55 * 0x2, CheckContactOpenTickets_1[a7(0x1fa)])(H[a7(0x207)]['id']) : (F[a7(0x20a) + 'd'] = null, G[a7(0x1d8) + a6(0x1ca)] = null, M[a6(0x202) + a7(0x201)] = new j()[a6(0x1c8)]()));
        const L = x[a6(0x22d)](y, x[a6(0x1d2)]) ? x[a7(0x221)] : y, M = {};
        M[a6(0x1ea)] = L, M[a7(0x20d)] = B, M[a6(0x212)] = z;
        const N = M;
        x[a6(0x238)](L, x[a7(0x221)]) && (N[a6(0x1fd)] = new Date()[a7(0x1c8)]());
        if (x[a7(0x229)](J, x[a6(0x23d)]) && x[a7(0x22d)](L, x[a6(0x1eb)])) {
            if (x[a7(0x1c9)](x[a6(0x211)], x[a6(0x211)]))
                N[a6(0x20a) + 'd'] = null, N[a6(0x1d8) + a6(0x1ca)] = null, N[a6(0x202) + a7(0x201)] = new Date()[a6(0x1c8)]();
            else {
                const S = {};
                return S[a6(0x1fa)] = S, F && G[a6(0x1f8)] ? M : S;
            }
        }
        await H[a7(0x1ff)](N);
        if (x[a6(0x215)](J, x[a7(0x23d)]) && x[a7(0x1be)](L, x[a7(0x1eb)])) {
            if (x[a6(0x1be)](x[a6(0x1d5)], x[a6(0x1d5)])) {
                const S = {};
                S[a6(0x212)] = v, S[a7(0x1e0)] = t, S[a7(0x209)] = x[a7(0x1eb)], await (0x1603 + -0x143 + -0x14c0, CreateLogTicketService_1[a7(0x1fa)])(S);
            } else
                D[a6(0x1fd)] = new E()[a7(0x1c8)]();
        }
        if (x[a7(0x239)](L, x[a7(0x221)])) {
            if (x[a7(0x23c)](x[a6(0x20f)], x[a7(0x1ec)]))
                throw new C[(a6(0x1fa))](x[a7(0x22f)], -0x44f * -0x1 + 0x2181 + -0x90f * 0x4);
            else {
                const V = {};
                V[a6(0x212)] = v, V[a6(0x1e0)] = t, V[a7(0x209)] = x[a7(0x221)], await (-0x439 * 0x7 + 0xc2f * -0x1 + -0x1 * -0x29be, CreateLogTicketService_1[a7(0x1fa)])(V);
            }
        }
        if (x[a6(0x1d6)](J, x[a7(0x1eb)]) && x[a6(0x1c9)](L, x[a7(0x23d)])) {
            const W = {};
            W[a7(0x212)] = v, W[a6(0x1e0)] = t, W[a7(0x209)] = x[a6(0x23d)], await (0x1d2 * -0x15 + 0x43 * 0x6 + 0x24a8, CreateLogTicketService_1[a6(0x1fa)])(W);
        }
        if (u) {
            const X = {};
            X[a6(0x212)] = v, X[a6(0x1e0)] = t, X[a6(0x209)] = x[a6(0x220)], await (0x2 * 0x223 + -0x10df + -0xc99 * -0x1, CreateLogTicketService_1[a7(0x1fa)])(X);
            if (z) {
                if (x[a7(0x1c4)](x[a7(0x1c6)], x[a6(0x1c6)])) {
                    const Y = {};
                    Y[a6(0x212)] = z, Y[a6(0x1e0)] = t, Y[a6(0x209)] = x[a6(0x1f2)], await (-0x1212 + 0x1709 + 0x29 * -0x1f, CreateLogTicketService_1[a7(0x1fa)])(Y);
                } else {
                    const a0 = {};
                    a0[a7(0x21b)] = F, a0[a6(0x209)] = x[a6(0x216)], a0[a7(0x206)] = G, (-0x5e5 * -0x1 + 0xd5c + -0x1341, E[a7(0x1fa)])(a0);
                }
            }
        }
        await H[a6(0x1ce)]();
        u && await H[a6(0x213) + 'ue'](x[a7(0x1bf)], !![]);
        if (I) {
            const a0 = {};
            a0[a7(0x21b)] = A, a0[a6(0x209)] = x[a7(0x216)], a0[a7(0x206)] = H, (-0x1 * -0xac5 + -0x134a * -0x1 + -0x1e0f, socketEmit_1[a6(0x1fa)])(a0);
        }
        const O = {};
        O[a6(0x21b)] = A, O[a6(0x209)] = x[a6(0x1e9)], O[a7(0x206)] = H, (0x2277 + 0x248b + 0x4702 * -0x1, socketEmit_1[a6(0x1fa)])(O);
        const P = {};
        return P[a6(0x20e)] = H, P[a6(0x1c0)] = J, P[a7(0x1da)] = K, P;
    };
exports[a3(0x1fa)] = UpdateTicketService;