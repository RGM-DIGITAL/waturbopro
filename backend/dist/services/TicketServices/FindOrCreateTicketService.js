'use strict';
const ax = b, ay = b;
(function (c, d) {
    const av = b, aw = b, e = c();
    while (!![]) {
        try {
            const f = -parseInt(av(0x24c)) / (0xf * -0xe9 + -0x1ea9 + 0x2c51) * (-parseInt(av(0x251)) / (-0x2336 + -0x5 * 0x29f + 0x1 * 0x3053)) + -parseInt(aw(0x25e)) / (-0x257c * 0x1 + -0x125 * 0x8 + 0x2ea7) + parseInt(av(0x269)) / (0x1a7f + 0x2064 + -0x869 * 0x7) * (-parseInt(av(0x236)) / (0x1 * 0x1223 + -0x1ea1 + 0xc83 * 0x1)) + parseInt(av(0x24f)) / (0x2 * 0xe23 + -0xa * -0x33 + -0x1e3e) + -parseInt(aw(0x263)) / (-0x1a55 + 0xe62 + -0xdb * -0xe) + -parseInt(aw(0x200)) / (-0x15 * 0x16d + -0x1be4 + 0x1 * 0x39dd) * (-parseInt(av(0x1fd)) / (0x1 * 0x21a4 + -0xfb * 0x1c + -0x627)) + -parseInt(aw(0x246)) / (-0x20c3 * 0x1 + -0xe26 + 0x1 * 0x2ef3);
            if (f === d)
                break;
            else
                e['push'](e['shift']());
        } catch (g) {
            e['push'](e['shift']());
        }
    }
}(a, -0xe16be + -0x4 * -0x1d361 + 0x8db * 0x268));
function b(c, d) {
    const e = a();
    return b = function (f, g) {
        f = f - (-0x9 * 0x248 + -0x1a94 + 0x3110);
        let h = e[f];
        return h;
    }, b(c, d);
}
var __importDefault = this && this[ax(0x222) + ax(0x278)] || function (c) {
    const az = ax;
    return c && c[az(0x20f)] ? c : { 'default': c };
};
const m = {};
function a() {
    const aC = [
        'contactId',
        'isDeleted',
        'getTime',
        'setDataVal',
        'ate',
        'ticketId',
        'includes',
        'dZHNq',
        'waour',
        'getWallets',
        'LzjAN',
        'UBzqg',
        '__importDe',
        'closed',
        'etsToWalle',
        'extraInfo',
        'AFuup',
        'update',
        'user',
        'DirectTick',
        'body',
        'ls/Contact',
        'isGroup',
        'find',
        'type',
        'vices/help',
        'waba',
        'sService',
        'ers/CheckC',
        'tenantId',
        'fromMe',
        'value',
        '9373440wFFeuv',
        'qRDuS',
        'jFkTj',
        'name',
        'key',
        './ShowTick',
        'findOne',
        'trHvB',
        'yhaIy',
        'SwHmq',
        '../WbotSer',
        'fgGXN',
        'leys',
        'sage',
        'TtVbo',
        'messenger',
        '3054240VmArSc',
        'tags',
        'ls/Ticket',
        'Services/L',
        'defineProp',
        'HrWfb',
        '20521sXLqTs',
        'QOWGb',
        'CAVRr',
        '9644898gIUTAS',
        './CreateLo',
        '160jeSSjv',
        'open',
        'startedAtt',
        'DESC',
        'ContactBai',
        'rBfEP',
        '../Setting',
        'wpBRf',
        'ls/Campaig',
        'contact',
        'oHgWv',
        'oGKFj',
        'gTicketSer',
        '967461pRVtto',
        'channel',
        'enabled',
        'qZYgP',
        '../../help',
        '2487940BUDYXu',
        'sequelize',
        'whatsappId',
        'pending',
        'isCampaign',
        'PMRno',
        '4BfYBoe',
        'unreadMess',
        'aLiWd',
        'Message',
        'QxTBE',
        '../../mode',
        'whatsapp',
        'wiPdE',
        'tTrMU',
        'erty',
        'telegram',
        'associatio',
        'Emit',
        'hatBotFlow',
        'zFYkL',
        'fault',
        'ls/User',
        'istSetting',
        'ers/socket',
        'hblZo',
        'endanceAt',
        'default',
        'model',
        'ChKSN',
        'wallets',
        'BZFHK',
        'wzizm',
        'attributes',
        'ticket:upd',
        'isFarewell',
        'nContacts',
        'Welcome',
        'jeXXH',
        'GTCNA',
        'etService',
        'userId',
        'create',
        'payload',
        'updatedAt',
        'jTdwa',
        'lastMessag',
        'wFDQz',
        '1681794NONOyS',
        'Ocxev',
        'iHlcO',
        '24bmsNEu',
        'ls/Message',
        'include',
        'bgKIB',
        'vice',
        'messageId',
        'ers/Verify',
        'order',
        'ZIMmC',
        'VFoyV',
        'fsjcw',
        'ticket',
        'ages',
        'instagram',
        'BSfCN',
        '__esModule',
        'status',
        'getBodyMes',
        'where',
        'sSopY',
        'rCHqM',
        'isCreated'
    ];
    a = function () {
        return aC;
    };
    return a();
}
m[ay(0x235)] = !![], Object[ax(0x24a) + ay(0x272)](exports, ax(0x20f), m);
const sequelize_1 = require(ay(0x264)), Contact_1 = __importDefault(require(ay(0x26e) + ax(0x22b))), Ticket_1 = __importDefault(require(ay(0x26e) + ay(0x248))), User_1 = __importDefault(require(ax(0x26e) + ax(0x279))), ShowTicketService_1 = __importDefault(require(ay(0x23b) + ay(0x1f5))), CampaignContacts_1 = __importDefault(require(ax(0x26e) + ay(0x259) + ax(0x287))), socketEmit_1 = __importDefault(require(ax(0x262) + ax(0x27b) + ax(0x275))), CheckChatBotFlowWelcome_1 = __importDefault(require(ay(0x262) + ax(0x232) + ax(0x276) + ax(0x288))), CreateLogTicketService_1 = __importDefault(require(ax(0x250) + ax(0x25d) + ay(0x204))), Message_1 = __importDefault(require(ax(0x26e) + ax(0x201))), ListSettingsService_1 = __importDefault(require(ax(0x257) + ax(0x249) + ax(0x27a) + ay(0x231))), VerifyContactBaileys_1 = require(ay(0x240) + ay(0x22f) + ax(0x206) + ay(0x255) + ax(0x242)), FindOrCreateTicketService = async ({
        contact: E,
        whatsappId: F,
        unreadMessages: G,
        tenantId: H,
        groupContact: I,
        msg: J,
        isSync: K,
        channel: L
    }) => {
        const aA = ay, aB = ay, M = {};
        M[aA(0x21d)] = aB(0x252), M[aA(0x21e)] = function (a3, a4) {
            return a3 === a4;
        }, M[aA(0x23f)] = aB(0x20d), M[aB(0x261)] = function (a3, a4) {
            return a3 !== a4;
        }, M[aB(0x27c)] = aB(0x220), M[aA(0x20a)] = function (a3, a4) {
            return a3 === a4;
        }, M[aB(0x23e)] = aB(0x26f), M[aB(0x213)] = aB(0x20b), M[aB(0x282)] = aA(0x223), M[aB(0x270)] = aB(0x266), M[aA(0x277)] = aA(0x25a), M[aA(0x226)] = aB(0x225), M[aA(0x209)] = aA(0x247), M[aB(0x26d)] = aB(0x281), M[aA(0x23d)] = aA(0x239), M[aB(0x1f4)] = aA(0x228), M[aA(0x271)] = aB(0x217), M[aB(0x280)] = function (a3, a4) {
            return a3 !== a4;
        }, M[aA(0x20e)] = aA(0x221), M[aA(0x1fc)] = aB(0x273), M[aB(0x214)] = aB(0x230), M[aA(0x203)] = aA(0x245), M[aA(0x289)] = function (a3, a4) {
            return a3 > a4;
        }, M[aB(0x244)] = aB(0x285) + aA(0x21a), M[aB(0x256)] = aA(0x1ff), M[aA(0x1fa)] = aB(0x1f9), M[aB(0x25c)] = aA(0x254), M[aB(0x241)] = aA(0x24b), M[aB(0x238)] = aA(0x208), M[aA(0x24e)] = aB(0x283), M[aB(0x258)] = function (a3, a4) {
            return a3 === a4;
        }, M[aB(0x25b)] = aA(0x260), M[aB(0x237)] = aA(0x24d), M[aA(0x268)] = aA(0x1f7), M[aA(0x1fe)] = function (a3, a4) {
            return a3 && a4;
        }, M[aA(0x26b)] = aB(0x215);
        const N = M;
        let O;
        if (N[aA(0x21e)](L, N[aA(0x23f)])) {
            if (N[aA(0x261)](N[aA(0x27c)], N[aB(0x27c)])) {
                const a4 = {};
                return a4[aB(0x267) + aA(0x26c)] = !![], a4;
            } else
                O = J[aB(0x234)];
        } else
            O = J[aA(0x23a)][aA(0x234)];
        if (N[aB(0x20a)](L, N[aA(0x23e)]) && J && O) {
            const a4 = {};
            a4[aB(0x216)] = E['id'], a4[aA(0x205)] = J[aB(0x23a)]?.['id'];
            const a5 = {};
            a5[aA(0x212)] = a4;
            const a6 = await CampaignContacts_1[aA(0x27e)][aA(0x23c)](a5);
            if (a6?.['id']) {
                const a7 = {};
                return a7[aB(0x267) + aA(0x26c)] = !![], a7;
            }
        }
        if (J && J[aB(0x234)]) {
            const a8 = {};
            a8[aB(0x205)] = J[aA(0x23a)]?.['id'];
            const a9 = {};
            a9[aA(0x212)] = a8, a9[aB(0x202)] = [N[aA(0x213)]];
            const aa = await Message_1[aA(0x27e)][aA(0x23c)](a9);
            if (N[aB(0x21e)](aa?.[aB(0x20b)]?.[aA(0x210)], N[aB(0x282)]) && N[aB(0x21e)](aa?.[aB(0x20b)][aA(0x1fb) + 'e'], J[aA(0x22a)])) {
                const ab = aa[aB(0x20b)];
                return ab[aB(0x286) + aB(0x26c)] = !![], ab;
            }
        }
        const P = {
                [sequelize_1['Op']['or']]: [
                    N[aA(0x21d)],
                    N[aA(0x270)]
                ]
            }, Q = {};
        Q[aB(0x210)] = P, Q[aB(0x233)] = H, Q[aB(0x265)] = F, Q[aB(0x216)] = I ? I['id'] : E['id'];
        const R = {};
        R[aB(0x27f)] = Contact_1[aA(0x27e)], R['as'] = N[aA(0x277)], R[aB(0x202)] = [
            N[aA(0x226)],
            N[aA(0x209)],
            {
                'association': N[aB(0x26d)],
                'attributes': [
                    'id',
                    N[aA(0x23d)]
                ]
            }
        ];
        const S = {};
        S[aA(0x27f)] = User_1[aB(0x27e)], S['as'] = N[aA(0x1f4)], S[aB(0x284)] = [
            'id',
            N[aA(0x23d)]
        ];
        const T = {};
        T[aA(0x274) + 'n'] = N[aB(0x23e)], T[aA(0x284)] = [
            'id',
            N[aA(0x23d)],
            N[aB(0x271)]
        ];
        const U = {};
        U[aA(0x212)] = Q, U[aA(0x202)] = [
            R,
            S,
            T
        ];
        let V = await Ticket_1[aB(0x27e)][aB(0x23c)](U);
        if (V) {
            if (N[aB(0x280)](N[aA(0x20e)], N[aA(0x20e)])) {
                const ad = d[aA(0x20b)];
                return ad[aB(0x286) + aA(0x26c)] = !![], ad;
            } else {
                G = [
                    N[aA(0x1fc)],
                    N[aA(0x214)],
                    N[aB(0x23f)],
                    N[aA(0x203)]
                ][aA(0x21c)](L) && N[aA(0x289)](G, -0xc0b + -0x23 * -0x3c + 0x3d7) ? G += V[aB(0x26a) + aA(0x20c)] : G;
                const ad = {};
                ad[aB(0x26a) + aA(0x20c)] = G, await V[aA(0x227)](ad);
                const ae = {};
                return ae[aA(0x233)] = H, ae[aA(0x22e)] = N[aB(0x244)], ae[aB(0x1f8)] = V, (0x2b0 + -0x2 * 0xc9d + 0x168a, socketEmit_1[aA(0x27e)])(ae), V;
            }
        }
        if (I) {
            if (N[aA(0x280)](N[aA(0x256)], N[aA(0x256)]))
                e = f[aA(0x234)];
            else {
                const ag = {};
                ag[aA(0x216)] = I['id'], ag[aA(0x233)] = H, ag[aB(0x265)] = F;
                const ah = {};
                ah[aB(0x212)] = ag, ah[aA(0x207)] = [[
                        N[aA(0x1fa)],
                        N[aA(0x25c)]
                    ]], ah[aB(0x202)] = [
                    {
                        'model': Contact_1[aA(0x27e)],
                        'as': N[aA(0x277)],
                        'include': [
                            N[aB(0x226)],
                            N[aB(0x209)],
                            {
                                'association': N[aA(0x26d)],
                                'attributes': [
                                    'id',
                                    N[aB(0x23d)]
                                ]
                            }
                        ]
                    },
                    {
                        'model': User_1[aA(0x27e)],
                        'as': N[aA(0x1f4)],
                        'attributes': [
                            'id',
                            N[aB(0x23d)]
                        ]
                    },
                    {
                        'association': N[aB(0x23e)],
                        'attributes': [
                            'id',
                            N[aB(0x23d)],
                            N[aB(0x271)]
                        ]
                    }
                ], V = await Ticket_1[aA(0x27e)][aB(0x23c)](ah);
                if (V) {
                    const ai = {};
                    ai[aB(0x210)] = N[aB(0x270)], ai[aB(0x1f6)] = null, ai[aA(0x26a) + aB(0x20c)] = G, await V[aB(0x227)](ai);
                    const aj = {};
                    return aj[aB(0x233)] = H, aj[aB(0x22e)] = N[aB(0x244)], aj[aA(0x1f8)] = V, (0x37 * -0x83 + -0x2 * 0x1106 + 0x3e31, socketEmit_1[aB(0x27e)])(aj), V;
                }
            }
        } else {
            if (N[aA(0x21e)](N[aA(0x241)], N[aA(0x238)]))
                e = f[aA(0x23a)][aA(0x234)];
            else {
                const al = {
                        [sequelize_1['Op']['in']]: [
                            N[aB(0x21d)],
                            N[aA(0x270)]
                        ]
                    }, am = {};
                am[aA(0x210)] = al, am[aB(0x233)] = H, am[aB(0x265)] = F, am[aB(0x216)] = E['id'];
                const an = {};
                an[aB(0x212)] = am, an[aA(0x207)] = [[
                        N[aA(0x1fa)],
                        N[aB(0x25c)]
                    ]], an[aA(0x202)] = [
                    {
                        'model': Contact_1[aB(0x27e)],
                        'as': N[aA(0x277)],
                        'include': [
                            N[aB(0x226)],
                            N[aB(0x209)],
                            {
                                'association': N[aA(0x26d)],
                                'attributes': [
                                    'id',
                                    N[aB(0x23d)]
                                ]
                            }
                        ]
                    },
                    {
                        'model': User_1[aB(0x27e)],
                        'as': N[aB(0x1f4)],
                        'attributes': [
                            'id',
                            N[aA(0x23d)]
                        ]
                    },
                    {
                        'association': N[aA(0x23e)],
                        'attributes': [
                            'id',
                            N[aA(0x23d)],
                            N[aB(0x271)]
                        ]
                    }
                ], V = await Ticket_1[aA(0x27e)][aA(0x23c)](an);
                if (V) {
                    if (N[aA(0x20a)](N[aA(0x24e)], N[aB(0x24e)])) {
                        const ao = {};
                        ao[aA(0x210)] = N[aB(0x270)], ao[aB(0x1f6)] = null, ao[aA(0x26a) + aB(0x20c)] = G, await V[aB(0x227)](ao);
                        const ap = {};
                        return ap[aA(0x233)] = H, ap[aA(0x22e)] = N[aA(0x244)], ap[aB(0x1f8)] = V, (-0x249c + -0x1 * 0x156f + -0x3a0b * -0x1, socketEmit_1[aA(0x27e)])(ap), V;
                    } else
                        h[aA(0x210)] = N[aA(0x21d)], P[aB(0x1f6)] = Q[0x15b3 + -0x1574 + 0x9 * -0x7]['id'], R[aA(0x253) + aA(0x27d)] = new S()[aB(0x218)]();
                }
            }
        }
        const W = N[aA(0x258)]((await (0x1 * -0x21bb + -0x101 * -0x1d + 0x49e, ListSettingsService_1[aA(0x27e)])(H))?.[aB(0x22d)](ar => ar[aA(0x23a)] === aB(0x229) + aB(0x224) + 'ts')?.[aA(0x235)], N[aB(0x25b)]) || ![], X = {};
        X[aB(0x216)] = I ? I['id'] : E['id'], X[aA(0x210)] = N[aB(0x270)], X[aA(0x22c)] = !!I, X[aB(0x26a) + aA(0x20c)] = G, X[aB(0x265)] = F, X[aB(0x233)] = H, X[aA(0x25f)] = L;
        const Y = X;
        if (W && E['id']) {
            const ar = E, as = await ar[aB(0x21f)]();
            if (as && as[0x13f * -0x3 + 0x1725 + -0x678 * 0x3]?.['id']) {
                if (N[aA(0x258)](N[aA(0x237)], N[aB(0x237)]))
                    Y[aA(0x210)] = N[aA(0x21d)], Y[aA(0x1f6)] = as[0x11dd + 0x15cd + -0x1 * 0x27aa]['id'], Y[aB(0x253) + aB(0x27d)] = new Date()[aB(0x218)]();
                else {
                    const au = {};
                    return au[aA(0x27e)] = Q, g && h[aB(0x20f)] ? P : au;
                }
            }
        }
        J && (Y[aA(0x1fb) + 'e'] = await (-0x13 * -0x1b1 + -0x2 * -0x1178 + 0x1 * -0x4313, VerifyContactBaileys_1[aA(0x211) + aB(0x243)])(J));
        const Z = await Ticket_1[aB(0x27e)][aA(0x1f7)](Y), a0 = {};
        a0[aA(0x21b)] = Z['id'], a0[aA(0x22e)] = N[aB(0x268)], await (0x157a + 0x5 * -0xe5 + 0x5ab * -0x3, CreateLogTicketService_1[aA(0x27e)])(a0);
        (N[aA(0x1fe)](J, !O) || !Z[aA(0x1f6)] || K) && await (-0x1bc1 + -0x1dd8 + 0x3 * 0x1333, CheckChatBotFlowWelcome_1[aB(0x27e)])(Z);
        const a1 = {};
        a1['id'] = Z['id'], a1[aB(0x233)] = H, V = await (0x79f * -0x1 + -0x55 * -0x4 + 0x64b, ShowTicketService_1[aB(0x27e)])(a1), V[aA(0x219) + 'ue'](N[aB(0x26b)], !![]);
        const a2 = {};
        return a2[aA(0x233)] = H, a2[aA(0x22e)] = N[aA(0x244)], a2[aB(0x1f8)] = V, (0x287 * -0x5 + 0x146e + 0x7 * -0x11d, socketEmit_1[aA(0x27e)])(a2), V;
    };
exports[ax(0x27e)] = FindOrCreateTicketService;