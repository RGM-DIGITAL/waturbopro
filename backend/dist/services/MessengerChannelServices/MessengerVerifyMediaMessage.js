'use strict';
function b(c, d) {
    const e = a();
    return b = function (f, g) {
        f = f - (0x8c3 * 0x3 + 0x1c * 0x7 + -0x191c);
        let h = e[f];
        return h;
    }, b(c, d);
}
const z = b, A = b;
(function (c, d) {
    const x = b, y = b, e = c();
    while (!![]) {
        try {
            const f = parseInt(x(0x1ff)) / (-0x1093 * -0x1 + -0x4d8 * 0x8 + 0x162e) * (parseInt(x(0x21a)) / (-0x339 * 0x2 + 0x43 * 0x36 + -0x7ae)) + parseInt(x(0x210)) / (-0x167a + -0x3b6 + 0x1a33) * (parseInt(x(0x216)) / (-0x59 + 0x579 * 0x7 + -0x25f2)) + -parseInt(x(0x240)) / (0x1 * 0x4e3 + -0x1e65 + -0x5 * -0x51b) * (parseInt(y(0x204)) / (-0x18f + -0xca0 + -0x1 * -0xe35)) + parseInt(x(0x23d)) / (-0x14a2 + 0x1b89 + -0x6e * 0x10) + parseInt(x(0x235)) / (0x64b + 0x22a * -0x8 + 0xb0d) * (-parseInt(y(0x233)) / (-0x1f * -0x125 + -0x1bae + -0x7c4)) + -parseInt(y(0x222)) / (0x2eb * 0x6 + -0x353 * 0x5 + -0xd9) * (-parseInt(y(0x239)) / (0x1769 + 0x1b * 0xa6 + -0x1470 * 0x2)) + -parseInt(x(0x1f3)) / (-0x200a + -0x23df + -0x43f5 * -0x1);
            if (f === d)
                break;
            else
                e['push'](e['shift']());
        } catch (g) {
            e['push'](e['shift']());
        }
    }
}(a, -0x13a642 + 0x2 * 0x5d9db + 0x125886));
function a() {
    const M = [
        'parameters',
        'mqfWy',
        'HJeXZ',
        'type',
        'join',
        'method',
        'error',
        'axios',
        '1Meuzve',
        'value',
        'LDYPh',
        'all',
        'payload',
        '6vKLGAo',
        'pipe',
        'PxIKo',
        'dtPgK',
        'tedForMess',
        'fuqXr',
        'update',
        'ERROR\x20DONW',
        'getTime',
        'content-ty',
        '../../help',
        'createWrit',
        '2445585tJHOZk',
        'defineProp',
        'Services/C',
        'eStream',
        'ghGBr',
        'kRifS',
        '4YNRxzL',
        'message_id',
        'messageDat',
        'fault',
        '12396JFdmzJ',
        'reply_to',
        'erty',
        '__esModule',
        'dIYiS',
        'fromMe',
        'cCLxz',
        'split',
        '30kfAzBQ',
        'mid',
        'headers',
        'uAVQH',
        'LOAD',
        'AoJVV',
        'message',
        'default',
        'AUoyL',
        'timestamp',
        'data',
        'finish',
        'PHJXx',
        'pmIZU',
        'ouByK',
        'geService',
        'filename',
        '4999599EnsmCh',
        'stream',
        '16cMlepq',
        'parse',
        'ers/getQuo',
        'content-di',
        '1597365CFSIFR',
        'sposition',
        'attachment',
        'map',
        '8786085AIlWus',
        'SsuOG',
        'received',
        '506040YwkVQf',
        'tenantId',
        'GET',
        'path',
        '../Message',
        'url',
        'KeMHg',
        'zGbug',
        'aSsIy',
        '__importDe',
        'text',
        'ageId',
        'pPIaF',
        'public',
        'reateMessa',
        '7421964WQmbvO',
        'responseTy',
        'nqlwo',
        'iMKLM'
    ];
    a = function () {
        return M;
    };
    return a();
}
var __importDefault = this && this[z(0x249) + A(0x219)] || function (c) {
    const B = A;
    return c && c[B(0x21d)] ? c : { 'default': c };
};
const w = {};
w[A(0x200)] = !![], Object[z(0x211) + z(0x21c)](exports, z(0x21d), w);
const path_1 = require(z(0x243)), axios_1 = __importDefault(require(A(0x1fe))), fs_1 = require('fs'), content_disposition_1 = __importDefault(require(A(0x238) + A(0x23a))), CreateMessageService_1 = __importDefault(require(A(0x244) + z(0x212) + z(0x1f2) + z(0x231))), getQuotedForMessageId_1 = __importDefault(require(z(0x20e) + A(0x237) + z(0x208) + z(0x24b))), downloadFile = async (e, f) => {
        const C = z, D = A, g = {
                'dtPgK': C(0x20b) + C(0x226),
                'pmIZU': function (o, p) {
                    return o(p);
                },
                'fuqXr': D(0x20d) + 'pe',
                'aSsIy': C(0x22d),
                'HJeXZ': D(0x1fd),
                'ghGBr': D(0x242),
                'AUoyL': D(0x234),
                'SsuOG': D(0x238) + D(0x23a),
                'cCLxz': function (o, p) {
                    return o !== p;
                },
                'kRifS': C(0x21e),
                'iMKLM': C(0x1f8),
                'KeMHg': function (o, p) {
                    return o === p;
                },
                'ouByK': C(0x24c),
                'AoJVV': C(0x1f1)
            }, h = {};
        h[D(0x245)] = e, h[D(0x1fc)] = g[C(0x214)], h[D(0x1f4) + 'pe'] = g[C(0x22a)];
        const i = await (0x11 * 0x56 + 0xca1 + -0x1257, axios_1[C(0x229)])(h), j = {};
        j[C(0x1f7)] = {};
        const k = i[D(0x224)][g[D(0x23e)]] ? content_disposition_1[D(0x229)][D(0x236)](i[D(0x224)][g[C(0x23e)]] || '') : j;
        let l = '';
        const m = k?.[C(0x1f7)]?.[C(0x232)];
        if (m) {
            if (g[C(0x220)](g[C(0x215)], g[C(0x1f6)])) {
                const o = k[D(0x1f7)][C(0x232)];
                l = new Date()[D(0x20c)]() + '-' + o;
            } else
                h[D(0x1fd)](g[D(0x207)], i), g[D(0x22f)](j, new k(l));
        } else {
            if (g[D(0x246)](g[D(0x230)], g[C(0x230)])) {
                const q = i[C(0x224)][g[D(0x209)]], r = q[D(0x221)]('/')[0xbc * 0x1f + 0x8b1 + -0x53e * 0x6];
                l = f + '-' + new Date()[D(0x20c)]() + '.' + r;
            } else {
                const t = g[D(0x224)][g[C(0x209)]], u = t[C(0x221)]('/')[0x371 * -0x1 + 0x4e4 + -0x172];
                h = i + '-' + new j()[D(0x20c)]() + '.' + u;
            }
        }
        const n = (-0x29 * -0x16 + 0x10f + 0x3 * -0x187, path_1[D(0x1fb)])(__dirname, '..', '..', '..', g[C(0x227)], l);
        return await new Promise((t, u) => {
            const E = D, F = C;
            i[E(0x22c)][E(0x205)]((-0x24f0 + -0x638 * 0x2 + 0x3160, fs_1[F(0x20f) + E(0x213)])(n))['on'](g[F(0x248)], async () => t(l))['on'](g[E(0x1f9)], v => {
                const G = E, H = E;
                console[G(0x1fd)](g[G(0x207)], v), g[H(0x22f)](u, new Error(v));
            });
        }), l;
    }, MessengerVerifyMediaMessage = async (c, d, e, f) => {
        const I = A, J = z, g = {
                'LDYPh': function (i, j, k) {
                    return i(j, k);
                },
                'nqlwo': function (i, j) {
                    return i === j;
                },
                'uAVQH': I(0x206),
                'PHJXx': function (i, j) {
                    return i > j;
                },
                'zGbug': I(0x23f)
            };
        let h;
        await Promise[J(0x202)](d[J(0x228)][I(0x23b) + 's'][I(0x23c)](async (i, j) => {
            const K = J, L = J, k = e['id'] + '_' + d[K(0x217)];
            h = await g[L(0x201)](downloadFile, i[K(0x203)][K(0x245)], k);
            let l;
            if (d?.[K(0x228)]?.[L(0x21b)]?.[K(0x223)]) {
                if (g[L(0x1f5)](g[K(0x225)], g[K(0x225)])) {
                    const o = await (-0x1299 + 0xfe + 0x119b, getQuotedForMessageId_1[L(0x229)])(d[L(0x228)][L(0x21b)][K(0x223)], e[L(0x241)]);
                    l = o?.['id'] || undefined;
                } else {
                    const q = {};
                    return q[K(0x229)] = j, g && h[K(0x21d)] ? i : q;
                }
            }
            const m = {
                'messageId': g[K(0x22e)](j, 0x1 * 0xd49 + -0x1ab1 * -0x1 + -0x1 * 0x27fa) ? d[K(0x217)] + '__' + j : d[K(0x217)] || '',
                'ticketId': e['id'],
                'contactId': f['id'],
                'body': d[K(0x228)]?.[K(0x24a)] || '',
                'fromMe': d[L(0x21f)],
                'read': ![],
                'mediaUrl': h,
                'mediaType': d[L(0x1fa)],
                'quotedMsgId': l,
                'timestamp': +d[L(0x22b)],
                'status': g[K(0x247)]
            };
            await e[L(0x20a)]({
                'lastMessage': d[K(0x228)]?.[L(0x24a)] || h || '',
                'lastMessageAt': new Date()[L(0x20c)](),
                'answered': ![]
            });
            const n = {};
            n[L(0x218) + 'a'] = m, n[K(0x241)] = e[L(0x241)], await (0x25d9 + -0x1 * -0x979 + -0x2f52, CreateMessageService_1[K(0x229)])(n);
        }));
    };
exports[z(0x229)] = MessengerVerifyMediaMessage;