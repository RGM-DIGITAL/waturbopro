'use strict';
function b(c, d) {
    const e = a();
    return b = function (f, g) {
        f = f - (-0x1f9e + -0x8ae + 0x3 * 0xdc4);
        let h = e[f];
        return h;
    }, b(c, d);
}
function a() {
    const R = [
        'mimeType',
        'sended',
        '1218552uGRGOp',
        '../Message',
        'ERR_DOWNLO',
        '4238706sAqzKx',
        'oQPMF',
        'received',
        'message',
        'OdlvL',
        'defineProp',
        'fault',
        'value',
        'public',
        'FrWej',
        'mime_type',
        'ers/getQuo',
        'toString',
        'tedForMess',
        'ERROR\x20DONW',
        'writeFile',
        'geService',
        'LOAD',
        '4539906hxeYdj',
        'sage',
        'text',
        'audio',
        'SAD',
        'error',
        'createWrit',
        'split',
        'logger',
        'tTcHq',
        'tenantId',
        '10651600arTFWt',
        'GWZZj',
        '663871JhbUTQ',
        'PupSW',
        's/logger',
        'image/png',
        'file_name',
        'file_id',
        'essage',
        '4386420zIIzfe',
        'date',
        'axios',
        'type',
        'stream',
        'length',
        'SAV',
        'IzLIH',
        'edited_mes',
        'update',
        'promisify',
        'default',
        '__esModule',
        '2546910pWvBEu',
        'ageId',
        'kXBEn',
        'DJrHm',
        'telegram',
        'fileId',
        'Services/C',
        'eStream',
        'message_id',
        '../../help',
        'qFkUk',
        'iUQBT',
        'fileName',
        'VnXHw',
        '\x20ID:\x20',
        'video',
        'JPhTM',
        'eUdZT',
        'sticker',
        'reateMessa',
        'HhdSD',
        'image/webp',
        'caption',
        'hvFdH',
        'AD_MEDIA::',
        'GET',
        '../../util',
        'voice',
        'qWqff',
        'photo',
        'erty',
        'reply_to_m',
        'pipe',
        'is_animate',
        'document',
        'ImtGF',
        'kTkLt',
        'join',
        'getFileLin',
        'RnHwY',
        'iKVTL',
        'pjfMf',
        'YKAZD',
        'getFile',
        'util',
        '__importDe',
        'finish',
        'path',
        'SAS',
        'messageDat',
        '4UTjxWL',
        'data',
        'GaaOw',
        'riIRT',
        'getTime'
    ];
    a = function () {
        return R;
    };
    return a();
}
const E = b, F = b;
(function (c, d) {
    const C = b, D = b, e = c();
    while (!![]) {
        try {
            const f = -parseInt(C(0x140)) / (-0x1 * 0xa0b + -0x99b * 0x4 + 0x40a * 0xc) * (parseInt(C(0x117)) / (0x16 * 0x61 + 0x1df * 0xb + -0x1ce9)) + parseInt(C(0x154)) / (0x1e95 + -0x1172 + 0x2a * -0x50) + parseInt(D(0x11e)) / (-0x2 * 0x41c + -0xea9 + 0x1 * 0x16e5) + parseInt(C(0x147)) / (-0x4c6 + -0x51 * 0x7b + 0x2bb6 * 0x1) + -parseInt(C(0x121)) / (0x3 * -0x41f + 0x5 * 0x5c8 + -0x1085) + -parseInt(D(0x133)) / (0x14f1 * 0x1 + -0x2079 + 0xb8f) + parseInt(D(0x13e)) / (-0x3 * -0x5fb + 0x771 + 0x76 * -0x37);
            if (f === d)
                break;
            else
                e['push'](e['shift']());
        } catch (g) {
            e['push'](e['shift']());
        }
    }
}(a, -0x5 * -0x3d3a7 + -0x139c35 * 0x1 + 0x7b1 * 0x169));
var __importDefault = this && this[E(0x112) + F(0x127)] || function (c) {
    const G = E;
    return c && c[G(0x153)] ? c : { 'default': c };
};
const u = {};
u[E(0x128)] = !![], Object[E(0x126) + E(0x103)](exports, F(0x153), u);
const path_1 = require(E(0x114)), util_1 = require(E(0x111)), fs_1 = require('fs'), axios_1 = __importDefault(require(F(0x149))), CreateMessageService_1 = __importDefault(require(E(0x11f) + E(0x15a) + F(0x167) + F(0x131))), logger_1 = require(F(0x16e) + E(0x142)), getQuotedForMessageId_1 = __importDefault(require(F(0x15d) + F(0x12c) + E(0x12e) + F(0x155))), writeFileAsync = (0x8 * -0x42c + 0xf43 + 0x121d * 0x1, util_1[F(0x151)])(fs_1[F(0x130)]), getMediaInfo = j => {
        const H = F, I = F, k = {};
        k[H(0x10e)] = I(0x102), k[H(0x15f)] = H(0x163), k[H(0x161)] = H(0x136), k[H(0x156)] = I(0x100), k[I(0x101)] = H(0x166), k[H(0x11a)] = H(0x107), k[I(0x122)] = function (w, z) {
            return w - z;
        }, k[H(0x16b)] = function (w, z) {
            return w == z;
        }, k[H(0x165)] = H(0x143), k[H(0x12a)] = H(0x169);
        const l = k, m = j[I(0x102)] ? l[I(0x10e)] : j[H(0x163)] ? l[H(0x15f)] : j[H(0x136)] ? l[H(0x161)] : j[H(0x100)] ? l[I(0x156)] : j[H(0x166)] && !j[H(0x166)][H(0x106) + 'd'] ? l[H(0x101)] : l[H(0x11a)], n = j[m], [o, p, q, r, s, t, v] = [
                m,
                n[H(0x12b)] ? n[H(0x12b)] : '',
                ![],
                null,
                n[H(0x145)] ? n[I(0x145)] : n[l[I(0x122)](n[I(0x14c)], 0xc68 * 0x2 + -0x2 * 0x564 + -0xe07)][H(0x145)],
                j[H(0x16a)] ? j[I(0x16a)] : '',
                l[H(0x16b)](m, l[I(0x156)])
            ];
        switch (m) {
        case l[I(0x10e)]:
            const w = {};
            w[H(0x14a)] = o, w[I(0x11c)] = l[H(0x165)], w[H(0x137)] = q, w[H(0x160)] = r, w[H(0x159)] = s, w[I(0x16a)] = t, w[I(0x14d)] = v;
            return w;
            break;
        case l[H(0x15f)]:
            const x = {};
            x[I(0x14a)] = o, x[I(0x11c)] = p, x[H(0x137)] = q, x[H(0x160)] = r, x[I(0x159)] = s, x[H(0x16a)] = t, x[H(0x14d)] = v;
            return x;
            break;
        case l[I(0x161)]:
            const y = {};
            y[I(0x14a)] = o, y[H(0x11c)] = p, y[H(0x137)] = q, y[I(0x160)] = r, y[H(0x159)] = s, y[H(0x16a)] = t, y[H(0x14d)] = v;
            return y;
            break;
        case l[I(0x156)]:
            const z = {};
            z[H(0x14a)] = o, z[I(0x11c)] = p, z[H(0x137)] = q, z[I(0x160)] = r, z[H(0x159)] = s, z[I(0x16a)] = t, z[I(0x14d)] = v;
            return z;
            break;
        case l[H(0x101)]:
            const A = {};
            A[I(0x14a)] = o, A[I(0x11c)] = l[I(0x12a)], A[H(0x137)] = q, A[I(0x160)] = r, A[I(0x159)] = s, A[H(0x16a)] = t, A[I(0x14d)] = v, A[H(0x115)] = !![];
            return A;
            break;
        default:
            const B = {};
            B[I(0x14a)] = o, B[H(0x11c)] = p, B[I(0x137)] = !![], B[H(0x160)] = n[I(0x144)] ? n[H(0x144)] : null, B[H(0x159)] = s, B[I(0x16a)] = t, B[I(0x14d)] = v;
            return B;
            break;
        }
    }, downloadFile = async (c, d) => {
        const J = E, K = F, e = {
                'ImtGF': J(0x12f) + J(0x132),
                'RnHwY': function (g, h) {
                    return g(h);
                },
                'qFkUk': K(0x113),
                'kTkLt': K(0x138),
                'GaaOw': K(0x16d),
                'IzLIH': J(0x14b)
            }, f = await (0x875 * 0x3 + -0x199e + 0x7 * 0x9, axios_1[K(0x152)])({
                'url': c[J(0x12d)](),
                'method': e[K(0x119)],
                'responseType': e[K(0x14e)]
            });
        await new Promise((g, h) => {
            const L = J, M = J;
            f[L(0x118)][M(0x105)]((0x6e + 0x1a3f + -0x1aad, fs_1[M(0x139) + M(0x15b)])(d))['on'](e[M(0x15e)], async () => g(!![]))['on'](e[M(0x109)], i => {
                const N = M, O = M;
                console[N(0x138)](e[O(0x108)], i), e[N(0x10c)](h, new Error(i));
            });
        });
    }, VerifyMediaMessage = async (d, e, f, g) => {
        const P = E, Q = E, h = {
                'YKAZD': function (v, w) {
                    return v && w;
                },
                'DJrHm': function (v, w) {
                    return v(w);
                },
                'PupSW': P(0x129),
                'tTcHq': function (v, w, x) {
                    return v(w, x);
                },
                'HhdSD': function (v, w) {
                    return v(w);
                },
                'GWZZj': function (v, w) {
                    return v * w;
                },
                'JPhTM': Q(0x11d),
                'iKVTL': Q(0x123),
                'OdlvL': function (v, w) {
                    return v || w;
                }
            };
        let i, j = {};
        i = d?.[Q(0x124)], j = d?.[P(0x150)];
        h[Q(0x10f)](!i, j) && (i = j?.[Q(0x14f) + Q(0x134)]);
        const k = await h[P(0x157)](getMediaInfo, i), l = await d[Q(0x158)][Q(0x110)](k[P(0x159)]);
        if (!l) {
            logger_1[Q(0x13b)][P(0x138)](Q(0x120) + Q(0x16c) + P(0x162) + i[P(0x15c)]);
            return;
        }
        const m = k[P(0x11c)][Q(0x13a)]('/')[0x314 + 0xe * -0x2aa + 0x2239][P(0x13a)](';')[-0x221e + 0xc5 * -0x3 + 0x175 * 0x19], n = l[Q(0x145)] + '_' + new Date()[Q(0x11b)]() + '.' + m, o = (0x2 * 0xaa6 + -0x1a1 * -0x16 + -0x47 * 0xce, path_1[Q(0x10a)])(__dirname, '..', '..', '..', h[Q(0x141)], n), p = await d[P(0x158)][P(0x10b) + 'k'](k[P(0x159)]);
        await h[Q(0x13c)](downloadFile, p, o);
        let q;
        if (i?.[P(0x104) + Q(0x146)]?.[P(0x15c)]) {
            const v = await (-0x1db6 * 0x1 + 0xd6 * 0x16 + -0xb52 * -0x1, getQuotedForMessageId_1[P(0x152)])(i[Q(0x104) + P(0x146)][Q(0x15c)], f[P(0x13d)]);
            q = v?.['id'] || undefined;
        }
        const r = {
            'messageId': h[P(0x168)](String, i?.[Q(0x15c)]),
            'ticketId': f['id'],
            'contactId': e ? undefined : g['id'],
            'body': i[Q(0x135)] || i[P(0x16a)] || n,
            'fromMe': e,
            'read': e,
            'mediaUrl': n,
            'mediaType': k[P(0x11c)][Q(0x13a)]('/')[0x65d * -0x5 + 0x2134 + 0x163 * -0x1],
            'quotedMsgId': q,
            'timestamp': h[P(0x13f)](+i[P(0x148)], 0x7 * 0x4f8 + -0x1ab4 + -0x42c),
            'status': e ? h[Q(0x164)] : h[Q(0x10d)]
        };
        await f[P(0x150)]({
            'lastMessage': i[Q(0x135)] || i[P(0x16a)] || n,
            'lastMessageAt': new Date()[Q(0x11b)](),
            'answered': h[P(0x125)](e, ![])
        });
        const s = {};
        s[Q(0x116) + 'a'] = r, s[Q(0x13d)] = f[P(0x13d)];
        const t = await (0xe23 + 0x33d + -0x1160, CreateMessageService_1[P(0x152)])(s);
        return t;
    };
exports[E(0x152)] = VerifyMediaMessage;